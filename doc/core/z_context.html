<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Module z_context</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module z_context</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>Request context for zophenic request evaluation.
<p>Copyright © 2009  Marc Worrell</p>

<p><b>Authors:</b> Marc Worrell (<a href="mailto:marc@worrell.nl"><tt>marc@worrell.nl</tt></a>).</p>

<h2><a name="description">Description</a></h2>Request context for zophenic request evaluation.
<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#abs_url-2">abs_url/2</a></td><td>Make the url an absolute url by prepending the hostname.</td></tr>
<tr><td valign="top"><a href="#add_script_page-1">add_script_page/1</a></td><td>Add the script from the context to the page in the user agent.</td></tr>
<tr><td valign="top"><a href="#add_script_page-2">add_script_page/2</a></td><td>Add a script to the page in the user agent.</td></tr>
<tr><td valign="top"><a href="#add_script_session-1">add_script_session/1</a></td><td>Add the script from the context to all pages of the session.</td></tr>
<tr><td valign="top"><a href="#add_script_session-2">add_script_session/2</a></td><td>Add a script to the all pages of the session.</td></tr>
<tr><td valign="top"><a href="#clean_scripts-1">clean_scripts/1</a></td><td>Remove all scripts from the context.</td></tr>
<tr><td valign="top"><a href="#combine_results-2">combine_results/2</a></td><td>Merge the scripts and the rendered content of two contexts into Context1.</td></tr>
<tr><td valign="top"><a href="#continue_session-1">continue_session/1</a></td><td>Continue an existing session, if the session id is in the request.</td></tr>
<tr><td valign="top"><a href="#cookie_domain-1">cookie_domain/1</a></td><td>Fetch the cookie domain, defaults to 'undefined' which will equal the domain
  to the domain of the current request.</td></tr>
<tr><td valign="top"><a href="#copy_scripts-2">copy_scripts/2</a></td><td>Overwrite the scripts in Context with the scripts in From.</td></tr>
<tr><td valign="top"><a href="#depickle-1">depickle/1</a></td><td>Depickle a context for restoring from a database.</td></tr>
<tr><td valign="top"><a href="#document_domain-1">document_domain/1</a></td><td>The document domain used for cross domain iframe javascripts.</td></tr>
<tr><td valign="top"><a href="#ensure_all-1">ensure_all/1</a></td><td>Ensure session and page session and fetch and parse the query string.</td></tr>
<tr><td valign="top"><a href="#ensure_page_session-1">ensure_page_session/1</a></td><td>Ensure that we have a page session, used for comet and postback requests.</td></tr>
<tr><td valign="top"><a href="#ensure_qs-1">ensure_qs/1</a></td><td>Ensure that we have parsed the query string, fetch body if necessary.</td></tr>
<tr><td valign="top"><a href="#ensure_session-1">ensure_session/1</a></td><td>Ensure that we have a session, start a new session process when needed.</td></tr>
<tr><td valign="top"><a href="#get-2">get/2</a></td><td>Fetch the value of the context variable Key, return undefined when Key is not found.</td></tr>
<tr><td valign="top"><a href="#get-3">get/3</a></td><td>Fetch the value of the context variable Key, return Default when Key is not found.</td></tr>
<tr><td valign="top"><a href="#get_all-1">get_all/1</a></td><td>Return a proplist with all context variables.</td></tr>
<tr><td valign="top"><a href="#get_page-2">get_page/2</a></td><td>Fetch the value of the page variable Key.</td></tr>
<tr><td valign="top"><a href="#get_persistent-2">get_persistent/2</a></td><td>Fetch the value of the visitor variable Key.</td></tr>
<tr><td valign="top"><a href="#get_q-2">get_q/2</a></td><td>Get a request parameter, either from the query string or the post body.</td></tr>
<tr><td valign="top"><a href="#get_q-3">get_q/3</a></td><td>Get a request parameter, either from the query string or the post body.</td></tr>
<tr><td valign="top"><a href="#get_q_all-1">get_q_all/1</a></td><td>Get all parameters.</td></tr>
<tr><td valign="top"><a href="#get_q_all-2">get_q_all/2</a></td><td>Get the all the parameters with the same name, returns the empty list when non found.</td></tr>
<tr><td valign="top"><a href="#get_q_all_noz-1">get_q_all_noz/1</a></td><td>Get all query/post args, filter the zotonic internal args.</td></tr>
<tr><td valign="top"><a href="#get_q_validated-2">get_q_validated/2</a></td><td>Fetch a query parameter and perform the validation connected to the parameter.</td></tr>
<tr><td valign="top"><a href="#get_req_header-2">get_req_header/2</a></td><td>Get a request header.</td></tr>
<tr><td valign="top"><a href="#get_req_path-1">get_req_path/1</a></td><td>Return the request path.</td></tr>
<tr><td valign="top"><a href="#get_reqdata-1">get_reqdata/1</a></td><td>Return the webmachine request data of the context.</td></tr>
<tr><td valign="top"><a href="#get_resource_module-1">get_resource_module/1</a></td><td>Get the resource module handling the request.</td></tr>
<tr><td valign="top"><a href="#get_resp_header-2">get_resp_header/2</a></td><td>Get a response header.</td></tr>
<tr><td valign="top"><a href="#get_session-2">get_session/2</a></td><td>Fetch the value of the session variable Key.</td></tr>
<tr><td valign="top"><a href="#get_value-2">get_value/2</a></td><td>Find a key in the context, page, session or persistent state.</td></tr>
<tr><td valign="top"><a href="#has_session-1">has_session/1</a></td><td>Check if the current context has a session attached.</td></tr>
<tr><td valign="top"><a href="#hostname-1">hostname/1</a></td><td>Return the preferred hostname from the site configuration.</td></tr>
<tr><td valign="top"><a href="#hostname_port-1">hostname_port/1</a></td><td>Return the preferred hostname, including port, from the site configuration.</td></tr>
<tr><td valign="top"><a href="#incr-3">incr/3</a></td><td>Increment the context variable Key.</td></tr>
<tr><td valign="top"><a href="#incr_page-3">incr_page/3</a></td><td>Increment the page variable Key.</td></tr>
<tr><td valign="top"><a href="#incr_session-3">incr_session/3</a></td><td>Increment the session variable Key.</td></tr>
<tr><td valign="top"><a href="#is_request-1">is_request/1</a></td><td>Check if the current context is a request context.</td></tr>
<tr><td valign="top"><a href="#language-1">language/1</a></td><td>Return the selected language of the Context.</td></tr>
<tr><td valign="top"><a href="#merge_scripts-2">merge_scripts/2</a></td><td>Merge the scripts from context C into the context accumulator, used when collecting all scripts in an output stream.</td></tr>
<tr><td valign="top"><a href="#new-1">new/1</a></td><td>Return a new empty context, no request is initialized.</td></tr>
<tr><td valign="top"><a href="#new-2">new/2</a></td><td>Create a new context record for a host with a certain language.</td></tr>
<tr><td valign="top"><a href="#new_tests-0">new_tests/0</a></td><td>Create a new context used when testing parts of zotonic.</td></tr>
<tr><td valign="top"><a href="#output-2">output/2</a></td><td>Replace the contexts in the output with their rendered content and collect all scripts.</td></tr>
<tr><td valign="top"><a href="#persistent_id-1">persistent_id/1</a></td><td>Ensure that we have an id for the visitor.</td></tr>
<tr><td valign="top"><a href="#pickle-1">pickle/1</a></td><td>Pickle a context for storing in the database.</td></tr>
<tr><td valign="top"><a href="#prune_for_async-1">prune_for_async/1</a></td><td>Make the context safe to use in a async message.</td></tr>
<tr><td valign="top"><a href="#prune_for_database-1">prune_for_database/1</a></td><td>Cleanup a context so that it can be used exclusively for database connections.</td></tr>
<tr><td valign="top"><a href="#prune_for_scomp-2">prune_for_scomp/2</a></td><td>Cleanup a context for cacheable scomp handling.</td></tr>
<tr><td valign="top"><a href="#prune_for_template-1">prune_for_template/1</a></td><td>Cleanup a context for the output stream.</td></tr>
<tr><td valign="top"><a href="#set-2">set/2</a></td><td>Set the value of the context variables to all {Key, Value} properties.</td></tr>
<tr><td valign="top"><a href="#set-3">set/3</a></td><td>Set the value of the context variable Key to Value.</td></tr>
<tr><td valign="top"><a href="#set_language-2">set_language/2</a></td><td>Set the language of the context.</td></tr>
<tr><td valign="top"><a href="#set_page-3">set_page/3</a></td><td>Set the value of the page variable Key to Value.</td></tr>
<tr><td valign="top"><a href="#set_persistent-3">set_persistent/3</a></td><td>Set the value of the visitor variable Key to Value.</td></tr>
<tr><td valign="top"><a href="#set_reqdata-2">set_reqdata/2</a></td><td>Set the webmachine request data of the context.</td></tr>
<tr><td valign="top"><a href="#set_resource_module-2">set_resource_module/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#set_resp_header-3">set_resp_header/3</a></td><td>Set a response header for the request in the context.</td></tr>
<tr><td valign="top"><a href="#set_session-3">set_session/3</a></td><td>Set the value of the session variable Key to Value.</td></tr>
<tr><td valign="top"><a href="#site-1">site/1</a></td><td>Maps the host in the request to a site in the sites folder.</td></tr>
<tr><td valign="top"><a href="#spawn_link_page-4">spawn_link_page/4</a></td><td>Spawn a new process, link it to the page process.</td></tr>
<tr><td valign="top"><a href="#spawn_link_session-4">spawn_link_session/4</a></td><td>Spawn a new process, link it to the session process.</td></tr>
<tr><td valign="top"><a href="#streamhost-1">streamhost/1</a></td><td>Fetch the domain and port for stream (comet/websocket) connections.</td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="abs_url-2">abs_url/2</a></h3>
<div class="spec">
<p><tt>abs_url(Url::string(), Context) -&gt; string()</tt></p>
</div><p>Make the url an absolute url by prepending the hostname.</p>

<h3 class="function"><a name="add_script_page-1">add_script_page/1</a></h3>
<div class="spec">
<p><tt>add_script_page(Context) -&gt; any()</tt></p>
</div><p>Add the script from the context to the page in the user agent.</p>

<h3 class="function"><a name="add_script_page-2">add_script_page/2</a></h3>
<div class="spec">
<p><tt>add_script_page(Script, Context) -&gt; any()</tt></p>
</div><p>Add a script to the page in the user agent.  Used for comet feeds.</p>

<h3 class="function"><a name="add_script_session-1">add_script_session/1</a></h3>
<div class="spec">
<p><tt>add_script_session(Context) -&gt; any()</tt></p>
</div><p>Add the script from the context to all pages of the session.</p>

<h3 class="function"><a name="add_script_session-2">add_script_session/2</a></h3>
<div class="spec">
<p><tt>add_script_session(Script, Context) -&gt; any()</tt></p>
</div><p>Add a script to the all pages of the session. Used for comet feeds.</p>

<h3 class="function"><a name="clean_scripts-1">clean_scripts/1</a></h3>
<div class="spec">
<p><tt>clean_scripts(C::Context) -&gt; Context</tt></p>
</div><p>Remove all scripts from the context</p>

<h3 class="function"><a name="combine_results-2">combine_results/2</a></h3>
<div class="spec">
<p><tt>combine_results(C1::Context1, C2::Context2) -&gt; Context</tt></p>
</div><p>Merge the scripts and the rendered content of two contexts into Context1</p>

<h3 class="function"><a name="continue_session-1">continue_session/1</a></h3>
<div class="spec">
<p><tt>continue_session(Context) -&gt; any()</tt></p>
</div><p>Continue an existing session, if the session id is in the request.</p>

<h3 class="function"><a name="cookie_domain-1">cookie_domain/1</a></h3>
<div class="spec">
<p><tt>cookie_domain(Context) -&gt; list() | undefined</tt></p>
</div><p>Fetch the cookie domain, defaults to 'undefined' which will equal the domain
  to the domain of the current request.</p>

<h3 class="function"><a name="copy_scripts-2">copy_scripts/2</a></h3>
<div class="spec">
<p><tt>copy_scripts(From, Context) -&gt; Context</tt></p>
</div><p>Overwrite the scripts in Context with the scripts in From</p>

<h3 class="function"><a name="depickle-1">depickle/1</a></h3>
<div class="spec">
<p><tt>depickle(X1) -&gt; any()</tt></p>
</div><p>Depickle a context for restoring from a database</p>

<h3 class="function"><a name="document_domain-1">document_domain/1</a></h3>
<div class="spec">
<p><tt>document_domain(Context) -&gt; any()</tt></p>
</div><p>The document domain used for cross domain iframe javascripts</p>

<h3 class="function"><a name="ensure_all-1">ensure_all/1</a></h3>
<div class="spec">
<p><tt>ensure_all(Context) -&gt; any()</tt></p>
</div><p>Ensure session and page session and fetch and parse the query string</p>

<h3 class="function"><a name="ensure_page_session-1">ensure_page_session/1</a></h3>
<div class="spec">
<p><tt>ensure_page_session(Context) -&gt; any()</tt></p>
</div><p>Ensure that we have a page session, used for comet and postback requests</p>

<h3 class="function"><a name="ensure_qs-1">ensure_qs/1</a></h3>
<div class="spec">
<p><tt>ensure_qs(Context) -&gt; any()</tt></p>
</div><p>Ensure that we have parsed the query string, fetch body if necessary</p>

<h3 class="function"><a name="ensure_session-1">ensure_session/1</a></h3>
<div class="spec">
<p><tt>ensure_session(Context) -&gt; any()</tt></p>
</div><p>Ensure that we have a session, start a new session process when needed</p>

<h3 class="function"><a name="get-2">get/2</a></h3>
<div class="spec">
<p><tt>get(Key, Context) -&gt; Value | undefined</tt></p>
</div><p>Fetch the value of the context variable Key, return undefined when Key is not found.</p>

<h3 class="function"><a name="get-3">get/3</a></h3>
<div class="spec">
<p><tt>get(Key, Context, Default) -&gt; Value | Default</tt></p>
</div><p>Fetch the value of the context variable Key, return Default when Key is not found.</p>

<h3 class="function"><a name="get_all-1">get_all/1</a></h3>
<div class="spec">
<p><tt>get_all(Context) -&gt; PropList</tt></p>
</div><p>Return a proplist with all context variables.</p>

<h3 class="function"><a name="get_page-2">get_page/2</a></h3>
<div class="spec">
<p><tt>get_page(Key, Context) -&gt; Value</tt></p>
</div><p>Fetch the value of the page variable Key</p>

<h3 class="function"><a name="get_persistent-2">get_persistent/2</a></h3>
<div class="spec">
<p><tt>get_persistent(Key, Context) -&gt; Value</tt></p>
</div><p>Fetch the value of the visitor variable Key</p>

<h3 class="function"><a name="get_q-2">get_q/2</a></h3>
<div class="spec">
<p><tt>get_q(Key::string(), Context) -&gt; Value::string() | undefined</tt></p>
</div><p>Get a request parameter, either from the query string or the post body.  Post body has precedence over the query string.</p>

<h3 class="function"><a name="get_q-3">get_q/3</a></h3>
<div class="spec">
<p><tt>get_q(Key::string(), Context, Default) -&gt; Value::string()</tt></p>
</div><p>Get a request parameter, either from the query string or the post body.  Post body has precedence over the query string.</p>

<h3 class="function"><a name="get_q_all-1">get_q_all/1</a></h3>
<div class="spec">
<p><tt>get_q_all(Context) -&gt; [{Key::string(), [Values]}]</tt></p>
</div><p>Get all parameters.</p>

<h3 class="function"><a name="get_q_all-2">get_q_all/2</a></h3>
<div class="spec">
<p><tt>get_q_all(Key::string(), Context) -&gt; [Values]</tt></p>
</div><p>Get the all the parameters with the same name, returns the empty list when non found.</p>

<h3 class="function"><a name="get_q_all_noz-1">get_q_all_noz/1</a></h3>
<div class="spec">
<p><tt>get_q_all_noz(Context) -&gt; [{Key::string(), [Values]}]</tt></p>
</div><p>Get all query/post args, filter the zotonic internal args.</p>

<h3 class="function"><a name="get_q_validated-2">get_q_validated/2</a></h3>
<div class="spec">
<p><tt>get_q_validated(Keys::Key, Context) -&gt; Value</tt></p>
</div><p>Fetch a query parameter and perform the validation connected to the parameter. An exception {not_validated, Key}
       is thrown when there was no validator, when the validator is invalid or when the validation failed.</p>

<h3 class="function"><a name="get_req_header-2">get_req_header/2</a></h3>
<div class="spec">
<p><tt>get_req_header(Header, Context) -&gt; Value</tt></p>
</div><p>Get a request header</p>

<h3 class="function"><a name="get_req_path-1">get_req_path/1</a></h3>
<div class="spec">
<p><tt>get_req_path(Context) -&gt; list()</tt></p>
</div><p>Return the request path</p>

<h3 class="function"><a name="get_reqdata-1">get_reqdata/1</a></h3>
<div class="spec">
<p><tt>get_reqdata(Context) -&gt; #wm_reqdata{}</tt></p>
</div><p>Return the webmachine request data of the context</p>

<h3 class="function"><a name="get_resource_module-1">get_resource_module/1</a></h3>
<div class="spec">
<p><tt>get_resource_module(Context) -&gt; term()</tt></p>
</div><p>Get the resource module handling the request.</p>

<h3 class="function"><a name="get_resp_header-2">get_resp_header/2</a></h3>
<div class="spec">
<p><tt>get_resp_header(Header, Context) -&gt; Value</tt></p>
</div><p>Get a response header</p>

<h3 class="function"><a name="get_session-2">get_session/2</a></h3>
<div class="spec">
<p><tt>get_session(Key, Context) -&gt; Value</tt></p>
</div><p>Fetch the value of the session variable Key</p>

<h3 class="function"><a name="get_value-2">get_value/2</a></h3>
<div class="spec">
<p><tt>get_value(Key::string(), Context) -&gt; Value | undefined</tt></p>
</div><p>Find a key in the context, page, session or persistent state.</p>

<h3 class="function"><a name="has_session-1">has_session/1</a></h3>
<div class="spec">
<p><tt>has_session(Context) -&gt; any()</tt></p>
</div><p>Check if the current context has a session attached</p>

<h3 class="function"><a name="hostname-1">hostname/1</a></h3>
<div class="spec">
<p><tt>hostname(Context) -&gt; string()</tt></p>
</div><p>Return the preferred hostname from the site configuration</p>

<h3 class="function"><a name="hostname_port-1">hostname_port/1</a></h3>
<div class="spec">
<p><tt>hostname_port(Context) -&gt; string()</tt></p>
</div><p>Return the preferred hostname, including port, from the site configuration</p>

<h3 class="function"><a name="incr-3">incr/3</a></h3>
<div class="spec">
<p><tt>incr(Key, Value::Increment, Context) -&gt; {NewValue, NewContext}</tt></p>
</div><p>Increment the context variable Key</p>

<h3 class="function"><a name="incr_page-3">incr_page/3</a></h3>
<div class="spec">
<p><tt>incr_page(Key, Value::Increment, Context) -&gt; {NewValue, NewContext}</tt></p>
</div><p>Increment the page variable Key</p>

<h3 class="function"><a name="incr_session-3">incr_session/3</a></h3>
<div class="spec">
<p><tt>incr_session(Key, Value::Increment, Context) -&gt; {NewValue, NewContext}</tt></p>
</div><p>Increment the session variable Key</p>

<h3 class="function"><a name="is_request-1">is_request/1</a></h3>
<div class="spec">
<p><tt>is_request(Context) -&gt; any()</tt></p>
</div><p>Check if the current context is a request context</p>

<h3 class="function"><a name="language-1">language/1</a></h3>
<div class="spec">
<p><tt>language(Context) -&gt; any()</tt></p>
</div><p>Return the selected language of the Context</p>

<h3 class="function"><a name="merge_scripts-2">merge_scripts/2</a></h3>
<div class="spec">
<p><tt>merge_scripts(C::Context, Acc::ContextAcc) -&gt; Context</tt></p>
</div><p>Merge the scripts from context C into the context accumulator, used when collecting all scripts in an output stream</p>

<h3 class="function"><a name="new-1">new/1</a></h3>
<div class="spec">
<p><tt>new(Context::HostDescr) -&gt; Context2</tt>
<ul class="definitions"><li><tt>HostDescr = Context | atom() | ReqData</tt></li>
</ul></p>
</div><p>Return a new empty context, no request is initialized.</p>

<h3 class="function"><a name="new-2">new/2</a></h3>
<div class="spec">
<p><tt>new(Host, Lang) -&gt; any()</tt></p>
</div><p>Create a new context record for a host with a certain language.</p>

<h3 class="function"><a name="new_tests-0">new_tests/0</a></h3>
<div class="spec">
<p><tt>new_tests() -&gt; any()</tt></p>
</div><p>Create a new context used when testing parts of zotonic</p>

<h3 class="function"><a name="output-2">output/2</a></h3>
<div class="spec">
<p><tt>output(B::list(), Context) -&gt; {<a href="#type-io_list">io_list()</a>, Context}</tt></p>
</div><p>Replace the contexts in the output with their rendered content and collect all scripts</p>

<h3 class="function"><a name="persistent_id-1">persistent_id/1</a></h3>
<div class="spec">
<p><tt>persistent_id(Context) -&gt; any()</tt></p>
</div><p>Ensure that we have an id for the visitor</p>

<h3 class="function"><a name="pickle-1">pickle/1</a></h3>
<div class="spec">
<p><tt>pickle(Context) -&gt; tuple()</tt></p>
</div><p>Pickle a context for storing in the database</p>

<h3 class="function"><a name="prune_for_async-1">prune_for_async/1</a></h3>
<div class="spec">
<p><tt>prune_for_async(Context) -&gt; any()</tt></p>
</div><p>Make the context safe to use in a async message. This removes buffers and the db transaction.</p>

<h3 class="function"><a name="prune_for_database-1">prune_for_database/1</a></h3>
<div class="spec">
<p><tt>prune_for_database(Context) -&gt; any()</tt></p>
</div><p>Cleanup a context so that it can be used exclusively for database connections</p>

<h3 class="function"><a name="prune_for_scomp-2">prune_for_scomp/2</a></h3>
<div class="spec">
<p><tt>prune_for_scomp(VisibleFor, Context) -&gt; any()</tt></p>
</div><p>Cleanup a context for cacheable scomp handling.  Resets most of the accumulators to prevent duplicating
  between different (cached) renderings.</p>

<h3 class="function"><a name="prune_for_template-1">prune_for_template/1</a></h3>
<div class="spec">
<p><tt>prune_for_template(Context) -&gt; any()</tt></p>
</div><p>Cleanup a context for the output stream</p>

<h3 class="function"><a name="set-2">set/2</a></h3>
<div class="spec">
<p><tt>set(PropList, Context) -&gt; Context</tt></p>
</div><p>Set the value of the context variables to all {Key, Value} properties.</p>

<h3 class="function"><a name="set-3">set/3</a></h3>
<div class="spec">
<p><tt>set(Key, Value, Context) -&gt; Context</tt></p>
</div><p>Set the value of the context variable Key to Value</p>

<h3 class="function"><a name="set_language-2">set_language/2</a></h3>
<div class="spec">
<p><tt>set_language(Lang::atom(), Context::<a href="#type-context">context()</a>) -&gt; <a href="#type-context">context()</a></tt></p>
</div><p>Set the language of the context.</p>

<h3 class="function"><a name="set_page-3">set_page/3</a></h3>
<div class="spec">
<p><tt>set_page(Key, Value, Context) -&gt; Context</tt></p>
</div><p>Set the value of the page variable Key to Value</p>

<h3 class="function"><a name="set_persistent-3">set_persistent/3</a></h3>
<div class="spec">
<p><tt>set_persistent(Key, Value, Context) -&gt; Context</tt></p>
</div><p>Set the value of the visitor variable Key to Value</p>

<h3 class="function"><a name="set_reqdata-2">set_reqdata/2</a></h3>
<div class="spec">
<p><tt>set_reqdata(ReqData, Context) -&gt; #wm_reqdata{}</tt></p>
</div><p>Set the webmachine request data of the context</p>

<h3 class="function"><a name="set_resource_module-2">set_resource_module/2</a></h3>
<div class="spec">
<p><tt>set_resource_module(Module::atom(), Context) -&gt; NewContext</tt></p>
</div>

<h3 class="function"><a name="set_resp_header-3">set_resp_header/3</a></h3>
<div class="spec">
<p><tt>set_resp_header(Header, Value, Context) -&gt; NewContext</tt></p>
</div><p>Set a response header for the request in the context.</p>

<h3 class="function"><a name="set_session-3">set_session/3</a></h3>
<div class="spec">
<p><tt>set_session(Key, Value, Context) -&gt; Context</tt></p>
</div><p>Set the value of the session variable Key to Value</p>

<h3 class="function"><a name="site-1">site/1</a></h3>
<div class="spec">
<p><tt>site(Context::wm_reqdata) -&gt; atom()</tt></p>
</div><p>Maps the host in the request to a site in the sites folder.</p>

<h3 class="function"><a name="spawn_link_page-4">spawn_link_page/4</a></h3>
<div class="spec">
<p><tt>spawn_link_page(Module, Func, Args, Context) -&gt; any()</tt></p>
</div><p>Spawn a new process, link it to the page process.  Used for comet feeds.</p>

<h3 class="function"><a name="spawn_link_session-4">spawn_link_session/4</a></h3>
<div class="spec">
<p><tt>spawn_link_session(Module, Func, Args, Context) -&gt; any()</tt></p>
</div><p>Spawn a new process, link it to the session process.</p>

<h3 class="function"><a name="streamhost-1">streamhost/1</a></h3>
<div class="spec">
<p><tt>streamhost(Context) -&gt; list()</tt></p>
</div><p>Fetch the domain and port for stream (comet/websocket) connections</p>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Oct 13 2011, 14:45:56.</i></p>
</body>
</html>
