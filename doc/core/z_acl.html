<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Module z_acl</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module z_acl</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>Access control for Zotonic.
<p>Copyright © 2010 Marc Worrell
  Date: 2010-04-27</p>

<p><b>Authors:</b> Marc Worrell (<a href="mailto:marc@worrell.nl"><tt>marc@worrell.nl</tt></a>).</p>

<h2><a name="description">Description</a></h2>Access control for Zotonic.  Interfaces to modules implementing the ACL events.
<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#anondo-1">anondo/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#anondo-2">anondo/2</a></td><td>Call a function as the anonymous user.</td></tr>
<tr><td valign="top"><a href="#args_to_visible_for-1">args_to_visible_for/1</a></td><td>Translate "visible_for" parameter to the appropriate visibility level.</td></tr>
<tr><td valign="top"><a href="#cache_key-1">cache_key/1</a></td><td>Return a term that can be used as the ACL part of cache key.</td></tr>
<tr><td valign="top"><a href="#can_see-1">can_see/1</a></td><td>Return the max visible_for the current user can see.</td></tr>
<tr><td valign="top"><a href="#is_admin-1">is_admin/1</a></td><td>Check if the current user is the admin or a sudo action.</td></tr>
<tr><td valign="top"><a href="#is_allowed-3">is_allowed/3</a></td><td>Check if an action is allowed for the current actor.</td></tr>
<tr><td valign="top"><a href="#logoff-1">logoff/1</a></td><td>Log off, reset the acl field of the context.</td></tr>
<tr><td valign="top"><a href="#logon-2">logon/2</a></td><td>Log the user with the id on, fill the acl field of the context.</td></tr>
<tr><td valign="top"><a href="#rsc_deletable-2">rsc_deletable/2</a></td><td>Check if the resource is deletable by the current user.</td></tr>
<tr><td valign="top"><a href="#rsc_editable-2">rsc_editable/2</a></td><td>Check if the resource is editable by the current user.</td></tr>
<tr><td valign="top"><a href="#rsc_update_check-3">rsc_update_check/3</a></td><td>Filter the properties of an update.</td></tr>
<tr><td valign="top"><a href="#rsc_visible-2">rsc_visible/2</a></td><td>Check if the resource is visible for the current user.</td></tr>
<tr><td valign="top"><a href="#set_visible_for-2">set_visible_for/2</a></td><td>Set the acl fields of the context for the 'visible_for' setting.</td></tr>
<tr><td valign="top"><a href="#sudo-1">sudo/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#sudo-2">sudo/2</a></td><td>Call a function with admin privileges.</td></tr>
<tr><td valign="top"><a href="#user-1">user/1</a></td><td>Return the id of the current user.</td></tr>
<tr><td valign="top"><a href="#wm_is_authorized-2">wm_is_authorized/2</a></td><td>Convenience function, check if the current user has enough permissions, if not then
  redirect to the logon page.</td></tr>
<tr><td valign="top"><a href="#wm_is_authorized-3">wm_is_authorized/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#wm_is_authorized-4">wm_is_authorized/4</a></td><td></td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="anondo-1">anondo/1</a></h3>
<div class="spec">
<p><tt>anondo(Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="anondo-2">anondo/2</a></h3>
<div class="spec">
<p><tt>anondo(F::FuncDef, Context::#context{}) -&gt; FuncResult</tt></p>
</div><p>Call a function as the anonymous user.</p>

<h3 class="function"><a name="args_to_visible_for-1">args_to_visible_for/1</a></h3>
<div class="spec">
<p><tt>args_to_visible_for(Args::<a href="#type-proplist">proplist()</a>) -&gt; 0 | 1 | 2 | 3</tt></p>
</div><p>Translate "visible_for" parameter to the appropriate visibility level.</p>

<h3 class="function"><a name="cache_key-1">cache_key/1</a></h3>
<div class="spec">
<p><tt>cache_key(Context) -&gt; term()</tt></p>
</div><p>Return a term that can be used as the ACL part of cache key.</p>

<h3 class="function"><a name="can_see-1">can_see/1</a></h3>
<div class="spec">
<p><tt>can_see(Context) -&gt; any()</tt></p>
</div><p>Return the max visible_for the current user can see</p>

<h3 class="function"><a name="is_admin-1">is_admin/1</a></h3>
<div class="spec">
<p><tt>is_admin(Context) -&gt; any()</tt></p>
</div><p>Check if the current user is the admin or a sudo action</p>

<h3 class="function"><a name="is_allowed-3">is_allowed/3</a></h3>
<div class="spec">
<p><tt>is_allowed(Action, Object, Context) -&gt; any()</tt></p>
</div><p>Check if an action is allowed for the current actor.</p>

<h3 class="function"><a name="logoff-1">logoff/1</a></h3>
<div class="spec">
<p><tt>logoff(Context::#context{}) -&gt; #context{}</tt></p>
</div><p>Log off, reset the acl field of the context</p>

<h3 class="function"><a name="logon-2">logon/2</a></h3>
<div class="spec">
<p><tt>logon(Id::integer(), Context::#context{}) -&gt; #context{}</tt></p>
</div><p>Log the user with the id on, fill the acl field of the context</p>

<h3 class="function"><a name="rsc_deletable-2">rsc_deletable/2</a></h3>
<div class="spec">
<p><tt>rsc_deletable(Id, Context) -&gt; any()</tt></p>
</div><p>Check if the resource is deletable by the current user</p>

<h3 class="function"><a name="rsc_editable-2">rsc_editable/2</a></h3>
<div class="spec">
<p><tt>rsc_editable(Id, Context) -&gt; any()</tt></p>
</div><p>Check if the resource is editable by the current user</p>

<h3 class="function"><a name="rsc_update_check-3">rsc_update_check/3</a></h3>
<div class="spec">
<p><tt>rsc_update_check(Id, Props, Context) -&gt; any()</tt></p>
</div><p>Filter the properties of an update.  This is before any escaping.</p>

<h3 class="function"><a name="rsc_visible-2">rsc_visible/2</a></h3>
<div class="spec">
<p><tt>rsc_visible(Id, Context) -&gt; any()</tt></p>
</div><p>Check if the resource is visible for the current user</p>

<h3 class="function"><a name="set_visible_for-2">set_visible_for/2</a></h3>
<div class="spec">
<p><tt>set_visible_for(VisibleFor::integer(), Context::<a href="#type-context">context()</a>) -&gt; <a href="#type-context">context()</a></tt></p>
</div><p>Set the acl fields of the context for the 'visible_for' setting.  Used when rendering scomps.</p>

<h3 class="function"><a name="sudo-1">sudo/1</a></h3>
<div class="spec">
<p><tt>sudo(Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="sudo-2">sudo/2</a></h3>
<div class="spec">
<p><tt>sudo(F::FuncDef, Context::#context{}) -&gt; FuncResult</tt></p>
</div><p>Call a function with admin privileges.</p>

<h3 class="function"><a name="user-1">user/1</a></h3>
<div class="spec">
<p><tt>user(Context) -&gt; any()</tt></p>
</div><p>Return the id of the current user.</p>

<h3 class="function"><a name="wm_is_authorized-2">wm_is_authorized/2</a></h3>
<div class="spec">
<p><tt>wm_is_authorized(Allowed, Context) -&gt; any()</tt></p>
</div><p>Convenience function, check if the current user has enough permissions, if not then
  redirect to the logon page.</p>

<h3 class="function"><a name="wm_is_authorized-3">wm_is_authorized/3</a></h3>
<div class="spec">
<p><tt>wm_is_authorized(ACLs, ReqData, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="wm_is_authorized-4">wm_is_authorized/4</a></h3>
<div class="spec">
<p><tt>wm_is_authorized(Action, Object, ReqData, Context) -&gt; any()</tt></p>
</div>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Aug 12 2011, 20:01:39.</i></p>
</body>
</html>
