<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Module z_utils</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module z_utils</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>Misc utility functions for zotonic.
<p>Copyright © 2009 Marc Worrell
 
  Parts are from wf_utils.erl which is Copyright (c) 2008-2009 Rusty Klophaus
 </p>

<p><b>Authors:</b> Marc Worrell.</p>

<h2><a name="description">Description</a></h2>Misc utility functions for zotonic
<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#are_equal-2">are_equal/2</a></td><td>Check if two arguments are equal, optionally converting them.</td></tr>
<tr><td valign="top"><a href="#assert-2">assert/2</a></td><td>Check if an assertion is ok or failed.</td></tr>
<tr><td valign="top"><a href="#checksum-2">checksum/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#checksum_assert-3">checksum_assert/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#coalesce-1">coalesce/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#combine-2">combine/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#combine_defined-2">combine_defined/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode-2">decode/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode_value-2">decode_value/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#decode_value_expire-2">decode_value_expire/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#depickle-2">depickle/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode-2">encode/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode_value-2">encode_value/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#encode_value_expire-3">encode_value_expire/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#ensure_existing_module-1">ensure_existing_module/1</a></td><td>Ensure that the given string matches an existing module.</td></tr>
<tr><td valign="top"><a href="#f-1">f/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#f-2">f/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#flush_message-1">flush_message/1</a></td><td>Flush all incoming messages, used when receiving timer ticks to prevent multiple ticks.</td></tr>
<tr><td valign="top"><a href="#generate_username-2">generate_username/2</a></td><td>Generate a unique user name from a proplist.</td></tr>
<tr><td valign="top"><a href="#get_nth-2">get_nth/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#get_seconds-0">get_seconds/0</a></td><td>Return the current universal time in seconds.</td></tr>
<tr><td valign="top"><a href="#group_by-3">group_by/3</a></td><td>Group by a property or m_rsc property, keeps the input list in the same order.</td></tr>
<tr><td valign="top"><a href="#group_proplists-2">group_proplists/2</a></td><td>Given a list of proplists, make it a nested list with respect to a property, combining elements
  with the same property.</td></tr>
<tr><td valign="top"><a href="#hex_decode-1">hex_decode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#hex_encode-1">hex_encode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#index_proplist-2">index_proplist/2</a></td><td>Make a property list based on the value of a property
  For example:  [  [{a,b}], [{a,c}] ]  gives  [{a, [{a,b}]}, {c, [[{a,c}]]}].</td></tr>
<tr><td valign="top"><a href="#is_empty-1">is_empty/1</a></td><td>Check if a value is 'empty'.</td></tr>
<tr><td valign="top"><a href="#is_iolist-1">is_iolist/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#is_process_alive-1">is_process_alive/1</a></td><td>Multinode is_process_alive check.</td></tr>
<tr><td valign="top"><a href="#is_proplist-1">is_proplist/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#is_true-1">is_true/1</a></td><td>Check if the parameter could represent the logical value of "true".</td></tr>
<tr><td valign="top"><a href="#js_array-1">js_array/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#js_escape-1">js_escape/1</a></td><td>Javascript escape, see also: http://code.google.com/p/doctype/wiki/ArticleXSSInJavaScript.</td></tr>
<tr><td valign="top"><a href="#js_object-1">js_object/1</a></td><td>Create a javascript object from a proplist.</td></tr>
<tr><td valign="top"><a href="#js_object-2">js_object/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#lib_dir-0">lib_dir/0</a></td><td>Return an abspath to a directory relative to the application root.</td></tr>
<tr><td valign="top"><a href="#lib_dir-1">lib_dir/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#list_dir_recursive-1">list_dir_recursive/1</a></td><td>Return a list of all files in a directory, recursive depth first search for files not starting with a '.'.</td></tr>
<tr><td valign="top"><a href="#name_for_host-2">name_for_host/2</a></td><td>Return the name used in the context of a hostname.</td></tr>
<tr><td valign="top"><a href="#nested_proplist-1">nested_proplist/1</a></td><td>Scan the props of a proplist, when the prop is a list with a $.</td></tr>
<tr><td valign="top"><a href="#nested_proplist-2">nested_proplist/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#now-0">now/0</a></td><td>Return the current tick count.</td></tr>
<tr><td valign="top"><a href="#now_msec-0">now_msec/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#only_digits-1">only_digits/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#only_letters-1">only_letters/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#os_escape-1">os_escape/1</a></td><td>Simple escape function for command line arguments.</td></tr>
<tr><td valign="top"><a href="#os_filename-1">os_filename/1</a></td><td>Simple escape function for filenames as commandline arguments.</td></tr>
<tr><td valign="top"><a href="#pickle-2">pickle/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#prefix-2">prefix/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#prop_delete-2">prop_delete/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#prop_replace-3">prop_replace/3</a></td><td>Replace a property in a proplist.</td></tr>
<tr><td valign="top"><a href="#randomize-1">randomize/1</a></td><td>Simple randomize of a list.</td></tr>
<tr><td valign="top"><a href="#randomize-2">randomize/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#replace1-3">replace1/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#set_nth-3">set_nth/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#split-2">split/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#split_in-2">split_in/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#tempfile-0">tempfile/0</a></td><td>return a unique temporary filename.</td></tr>
<tr><td valign="top"><a href="#temppath-0">temppath/0</a></td><td>Returns the path where to store temporary files.</td></tr>
<tr><td valign="top"><a href="#url_decode-1">url_decode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#url_encode-1">url_encode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#url_path_encode-1">url_path_encode/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#url_reserved_char-1">url_reserved_char/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#url_unreserved_char-1">url_unreserved_char/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#url_valid_char-1">url_valid_char/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#vsplit_in-2">vsplit_in/2</a></td><td></td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="are_equal-2">are_equal/2</a></h3>
<div class="spec">
<p><tt>are_equal(Arg1, Arg2) -&gt; any()</tt></p>
</div><p>Check if two arguments are equal, optionally converting them</p>

<h3 class="function"><a name="assert-2">assert/2</a></h3>
<div class="spec">
<p><tt>assert(X1::bool(), Error::error) -&gt; none()</tt></p>
</div><p>Check if an assertion is ok or failed</p>

<h3 class="function"><a name="checksum-2">checksum/2</a></h3>
<div class="spec">
<p><tt>checksum(Data, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="checksum_assert-3">checksum_assert/3</a></h3>
<div class="spec">
<p><tt>checksum_assert(Data, Checksum, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="coalesce-1">coalesce/1</a></h3>
<div class="spec">
<p><tt>coalesce(T) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="combine-2">combine/2</a></h3>
<div class="spec">
<p><tt>combine(Sep, T) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="combine_defined-2">combine_defined/2</a></h3>
<div class="spec">
<p><tt>combine_defined(Sep, List) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode-2">decode/2</a></h3>
<div class="spec">
<p><tt>decode(Data, Base) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode_value-2">decode_value/2</a></h3>
<div class="spec">
<p><tt>decode_value(Data, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="decode_value_expire-2">decode_value_expire/2</a></h3>
<div class="spec">
<p><tt>decode_value_expire(Data, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="depickle-2">depickle/2</a></h3>
<div class="spec">
<p><tt>depickle(Data, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode-2">encode/2</a></h3>
<div class="spec">
<p><tt>encode(Data, Base) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode_value-2">encode_value/2</a></h3>
<div class="spec">
<p><tt>encode_value(Value, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="encode_value_expire-3">encode_value_expire/3</a></h3>
<div class="spec">
<p><tt>encode_value_expire(Value, Date, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="ensure_existing_module-1">ensure_existing_module/1</a></h3>
<div class="spec">
<p><tt>ensure_existing_module(ModuleName) -&gt; any()</tt></p>
</div><p>Ensure that the given string matches an existing module. Used to prevent
       a denial of service attack where we exhaust the atom space.</p>

<h3 class="function"><a name="f-1">f/1</a></h3>
<div class="spec">
<p><tt>f(S) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="f-2">f/2</a></h3>
<div class="spec">
<p><tt>f(S, Args) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="flush_message-1">flush_message/1</a></h3>
<div class="spec">
<p><tt>flush_message(Msg) -&gt; any()</tt></p>
</div><p>Flush all incoming messages, used when receiving timer ticks to prevent multiple ticks.</p>

<h3 class="function"><a name="generate_username-2">generate_username/2</a></h3>
<div class="spec">
<p><tt>generate_username(Props, Context) -&gt; any()</tt></p>
</div><p>Generate a unique user name from a proplist.</p>

<h3 class="function"><a name="get_nth-2">get_nth/2</a></h3>
<div class="spec">
<p><tt>get_nth(N, L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="get_seconds-0">get_seconds/0</a></h3>
<div class="spec">
<p><tt>get_seconds() -&gt; any()</tt></p>
</div><p>Return the current universal time in seconds</p>

<h3 class="function"><a name="group_by-3">group_by/3</a></h3>
<div class="spec">
<p><tt>group_by(L, Prop, Context) -&gt; any()</tt></p>
</div><p>Group by a property or m_rsc property, keeps the input list in the same order.</p>

<h3 class="function"><a name="group_proplists-2">group_proplists/2</a></h3>
<div class="spec">
<p><tt>group_proplists(Prop::Property, Rest::[PropList]) -&gt; PropList</tt></p>
</div><p>Given a list of proplists, make it a nested list with respect to a property, combining elements
  with the same property.  Assumes the list is sorted on the property you are splitting on
  For example:  [[{a,b}{x}], [{a,b}{z}], [{a,c}{y}]] gives:
    [ {b, [[{a,b}{x}], [{a,b}{z}]]},  {c, [[{a,c}{y}]]} ]</p>

<h3 class="function"><a name="hex_decode-1">hex_decode/1</a></h3>
<div class="spec">
<p><tt>hex_decode(Data) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="hex_encode-1">hex_encode/1</a></h3>
<div class="spec">
<p><tt>hex_encode(Data) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="index_proplist-2">index_proplist/2</a></h3>
<div class="spec">
<p><tt>index_proplist(Prop::Property, List::[PropList]) -&gt; PropList</tt></p>
</div><p>Make a property list based on the value of a property
  For example:  [  [{a,b}], [{a,c}] ]  gives  [{a, [{a,b}]}, {c, [[{a,c}]]}]</p>

<h3 class="function"><a name="is_empty-1">is_empty/1</a></h3>
<div class="spec">
<p><tt>is_empty(X1) -&gt; any()</tt></p>
</div><p>Check if a value is 'empty'</p>

<h3 class="function"><a name="is_iolist-1">is_iolist/1</a></h3>
<div class="spec">
<p><tt>is_iolist(C) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="is_process_alive-1">is_process_alive/1</a></h3>
<div class="spec">
<p><tt>is_process_alive(Pid) -&gt; any()</tt></p>
</div><p>Multinode is_process_alive check</p>

<h3 class="function"><a name="is_proplist-1">is_proplist/1</a></h3>
<div class="spec">
<p><tt>is_proplist(R) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="is_true-1">is_true/1</a></h3>
<div class="spec">
<p><tt>is_true(T) -&gt; any()</tt></p>
</div><p>Check if the parameter could represent the logical value of "true"</p>

<h3 class="function"><a name="js_array-1">js_array/1</a></h3>
<div class="spec">
<p><tt>js_array(L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="js_escape-1">js_escape/1</a></h3>
<div class="spec">
<p><tt>js_escape(Value) -&gt; any()</tt></p>
</div><p>Javascript escape, see also: http://code.google.com/p/doctype/wiki/ArticleXSSInJavaScript</p>

<h3 class="function"><a name="js_object-1">js_object/1</a></h3>
<div class="spec">
<p><tt>js_object(L) -&gt; any()</tt></p>
</div><p>Create a javascript object from a proplist</p>

<h3 class="function"><a name="js_object-2">js_object/2</a></h3>
<div class="spec">
<p><tt>js_object(L, T) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="lib_dir-0">lib_dir/0</a></h3>
<div class="spec">
<p><tt>lib_dir() -&gt; any()</tt></p>
</div><p>Return an abspath to a directory relative to the application root.
  This is used to prevent that we have to name the root dir "zotonic".</p>

<h3 class="function"><a name="lib_dir-1">lib_dir/1</a></h3>
<div class="spec">
<p><tt>lib_dir(Dir) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="list_dir_recursive-1">list_dir_recursive/1</a></h3>
<div class="spec">
<p><tt>list_dir_recursive(Dir) -&gt; any()</tt></p>
</div><p>Return a list of all files in a directory, recursive depth first search for files not starting with a '.'</p>

<h3 class="function"><a name="name_for_host-2">name_for_host/2</a></h3>
<div class="spec">
<p><tt>name_for_host(Name::atom(), Host::atom()) -&gt; atom()</tt></p>
</div><p>Return the name used in the context of a hostname</p>

<h3 class="function"><a name="nested_proplist-1">nested_proplist/1</a></h3>
<div class="spec">
<p><tt>nested_proplist(Props) -&gt; any()</tt></p>
</div><p>Scan the props of a proplist, when the prop is a list with a $. characters in it then split the prop.</p>

<h3 class="function"><a name="nested_proplist-2">nested_proplist/2</a></h3>
<div class="spec">
<p><tt>nested_proplist(T, Acc) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="now-0">now/0</a></h3>
<div class="spec">
<p><tt>now() -&gt; any()</tt></p>
</div><p>Return the current tick count</p>

<h3 class="function"><a name="now_msec-0">now_msec/0</a></h3>
<div class="spec">
<p><tt>now_msec() -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="only_digits-1">only_digits/1</a></h3>
<div class="spec">
<p><tt>only_digits(L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="only_letters-1">only_letters/1</a></h3>
<div class="spec">
<p><tt>only_letters(T) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="os_escape-1">os_escape/1</a></h3>
<div class="spec">
<p><tt>os_escape(A::String) -&gt; String</tt></p>
</div><p>Simple escape function for command line arguments</p>

<h3 class="function"><a name="os_filename-1">os_filename/1</a></h3>
<div class="spec">
<p><tt>os_filename(A::String) -&gt; String</tt></p>
</div><p>Simple escape function for filenames as commandline arguments.
  foo/"bar.jpg -&gt; "foo/\"bar.jpg"; on windows "foo\\\"bar.jpg" (both including quotes!)</p>

<h3 class="function"><a name="pickle-2">pickle/2</a></h3>
<div class="spec">
<p><tt>pickle(Data, Context) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="prefix-2">prefix/2</a></h3>
<div class="spec">
<p><tt>prefix(Sep, List) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="prop_delete-2">prop_delete/2</a></h3>
<div class="spec">
<p><tt>prop_delete(Prop, List) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="prop_replace-3">prop_replace/3</a></h3>
<div class="spec">
<p><tt>prop_replace(Prop, Value, List) -&gt; any()</tt></p>
</div><p>Replace a property in a proplist</p>

<h3 class="function"><a name="randomize-1">randomize/1</a></h3>
<div class="spec">
<p><tt>randomize(List) -&gt; any()</tt></p>
</div><p>Simple randomize of a list. Not good quality, but good enough for us</p>

<h3 class="function"><a name="randomize-2">randomize/2</a></h3>
<div class="spec">
<p><tt>randomize(N, List) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="replace1-3">replace1/3</a></h3>
<div class="spec">
<p><tt>replace1(F, T, L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="set_nth-3">set_nth/3</a></h3>
<div class="spec">
<p><tt>set_nth(N, V, L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="split-2">split/2</a></h3>
<div class="spec">
<p><tt>split(N, L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="split_in-2">split_in/2</a></h3>
<div class="spec">
<p><tt>split_in(L, N) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="tempfile-0">tempfile/0</a></h3>
<div class="spec">
<p><tt>tempfile() -&gt; string()</tt></p>
</div><p>return a unique temporary filename.</p>

<h3 class="function"><a name="temppath-0">temppath/0</a></h3>
<div class="spec">
<p><tt>temppath() -&gt; string()</tt></p>
</div><p>Returns the path where to store temporary files.</p>

<h3 class="function"><a name="url_decode-1">url_decode/1</a></h3>
<div class="spec">
<p><tt>url_decode(S) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="url_encode-1">url_encode/1</a></h3>
<div class="spec">
<p><tt>url_encode(S) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="url_path_encode-1">url_path_encode/1</a></h3>
<div class="spec">
<p><tt>url_path_encode(L) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="url_reserved_char-1">url_reserved_char/1</a></h3>
<div class="spec">
<p><tt>url_reserved_char(X1) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="url_unreserved_char-1">url_unreserved_char/1</a></h3>
<div class="spec">
<p><tt>url_unreserved_char(Ch) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="url_valid_char-1">url_valid_char/1</a></h3>
<div class="spec">
<p><tt>url_valid_char(Char) -&gt; any()</tt></p>
</div>

<h3 class="function"><a name="vsplit_in-2">vsplit_in/2</a></h3>
<div class="spec">
<p><tt>vsplit_in(L, N) -&gt; any()</tt></p>
</div>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Oct 13 2011, 14:45:55.</i></p>
</body>
</html>
