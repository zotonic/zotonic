<p>{_ You must set your two-factor authentication passcode now. Next time you sign in you will need to enter the two-factor authentication passcode. _}</p>
<p>{_ Scan the two-factor authentication barcode with an app such as <a href="https://support.google.com/accounts/answer/1066447">Google Authenticator</a> or <a href="https://duo.com/product/trusted-users/two-factor-authentication/duo-mobile">Duo Mobile</a>. _}</p>

<div style="margin: 50px 0">
{% with m.auth2fa.new_totp_image_url as totp %}
    <p style="text-align: center">
        <img src="{{ totp.url }}" style="width: 200px; height: 200px; max-width: 90%">
    </p>

    <p style="text-align: center">
        <input readonly
               type="hidden"
               value="{{ totp.secret }}"
               name="code-new"
               id="{{ #secret }}"
               style="text-align: center; border: none;">
        <a class="btn btn-xs btn-default" id="{{ #btn }}">
            <span class="fa fa-copy"></span> {_ Copy _}
        </a>
        {% wire id=#btn
                action={script
                    script="
                        document.getElementById('" ++ #secret ++ "').select();
                        document.execCommand('copy');
                    "
                }
                action={growl text=_"Copied to clipboard"}
        %}
    </p>
{% endwith %}
</div>

<div class="form-group">
    <p>{_ After you scanned the barcode, please enter the passcode generated by your two-factor authentication app below. _}</p>

    <label for="password" class="control-label">{_ Passcode generated by your app _}</label>
    <input class="form-control {% if not is_reset %}do_autofocus{% endif %}" type="text" id="test_passcode" name="test_passcode" value="" autocomplete="one-time-code" placeholder="{_ Two-factor passcode _}" inputmode="numeric" pattern="^[0-9]+$" required>

    {% validate id="test_passcode"
                type={presence}
                type={format pattern="^[0-9]+$"}
    %}
</div>
