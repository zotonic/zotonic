%% -*- mode: erlang -*-

{require_min_otp_vsn, "19"}.

{erl_opts, [
  {parse_transform, lager_transform},

  %% When you add patform defines, make sure they are picked up in zotonic_compile.erl
  {platform_define, "^([0-9]+)", namespaced_dicts},
  {platform_define, "^([0-9]+|R16)", coding_utf8},
  {platform_define, "^(R16|17)", no_ssl},
  {platform_define, "^R16", lists_nofiltermap},
  {platform_define, "^(19|2)", rand_only},
  {platform_define, "^(R|1|20)", fun_stacktrace}
 ]
}.

{deps,
 [
  {edown, ".*", {git, "https://github.com/uwiger/edown.git", {tag, "0.8.1"}}},
  {lager, ".*", {git, "https://github.com/basho/lager.git", {tag, "3.2.1"}}},
  {certifi, ".*", {git, "https://github.com/certifi/erlang-certifi.git", {tag, "2.5.1"}}},
  {rebar_lock_deps_plugin, ".*", {git, "https://github.com/seth/rebar_lock_deps_plugin.git", {branch, "master"}}},
  {erlware_commons,  ".*", {git, "https://github.com/erlware/erlware_commons.git", {tag, "v1.3.0"}}},
  {depcache, ".*", {git, "https://github.com/zotonic/depcache.git", {branch, "master"}}},
  {bert, ".*", {git, "https://github.com/zotonic/bert.erl.git", {branch, "master"}}},
  {dh_date, ".*", {git, "https://github.com/zotonic/dh_date.git", {branch, "master"}}},
  {eiconv, ".*", {git, "https://github.com/zotonic/eiconv.git", {branch, "master"}}},
  {gen_smtp, ".*", {git, "https://github.com/Vagabond/gen_smtp.git", {branch, "0.x"}}},
  {mimetypes, ".*", {git, "https://github.com/zotonic/mimetypes.git", {branch, "master"}}},
  {mochiweb, ".*", {git, "https://github.com/zotonic/mochiweb.git", {branch, "master"}}},
  {dispatch_compiler, ".*", {git, "https://github.com/zotonic/dispatch_compiler.git", {branch, "master"}}},
  {ua_classifier, ".*", {git, "https://github.com/zotonic/ua_classifier.git", {branch, "master"}}},
  {webzmachine, ".*", {git, "https://github.com/zotonic/webzmachine.git", {branch, "master"}}},
  {z_stdlib, ".*", {git, "https://github.com/zotonic/z_stdlib.git", {branch, "0.x"}}},
  {jsx, ".*", {git, "https://github.com/talentdeficit/jsx.git", {tag, "v3.0.0"}}},
  {jsxrecord, ".*", {git, "https://github.com/zotonic/jsxrecord.git", {branch, "master"}}},
  {parse_trans, ".*", {git, "https://github.com/uwiger/parse_trans.git", {tag, "3.3.0"}}},
  {exometer_core, ".*", {git, "https://github.com/Feuerlabs/exometer_core.git", {tag, "v1.5.7"}}},
  {filezcache, ".*", {git, "https://github.com/mworrell/filezcache.git", {branch, "master"}}},
  {s3filez, ".*", {git, "https://github.com/mworrell/s3filez.git", {branch, "master"}}},
  {proper, ".*", {git, "https://github.com/manopapad/proper.git", {branch, "master"}}},
  {diffy, ".*", {git, "https://github.com/mmzeeman/diffy.git", {branch, "master"}}},
  {goldrush, ".*", {git, "https://github.com/DeadZen/goldrush.git", {tag, "0.1.6"}}},
  {jobs, ".*", {git, "https://github.com/uwiger/jobs.git", {tag, "0.7.1"}}},
  {gproc, ".*", {git, "https://github.com/uwiger/gproc.git", {branch, "master"}}},
  {emqtt, ".*", {git, "https://github.com/zotonic/emqtt.git", {branch, "zotonic"}}},
  {poolboy,   ".*",   {git, "https://github.com/devinus/poolboy.git", {tag, "1.5.1"}}},
  {epgsql,   ".*",   {git, "https://github.com/epgsql/epgsql.git", {tag, "3.4.0"}}},
  {qdate_localtime, ".*", {git, "https://github.com/choptastic/qdate_localtime.git", {branch, "master"}}},
  {qdate, ".*", {git, "https://github.com/choptastic/qdate.git", {branch, "master"}}},
  {cf, ".*", {git, "https://github.com/project-fifo/cf.git", {branch, "master"}}},
  {jiffy, ".*", {git, "https://github.com/davisp/jiffy.git", {tag, "0.15.2"}}},
  {recon, ".*", {git, "https://github.com/ferd/recon.git", {branch, "2.x"}}},
  {exif, ".*", {git, "https://github.com/nlfiedler/erlang-exif.git", {branch, "master"}}},
  {termit, ".*", {git, "https://github.com/erlangpack/termit", {branch, "master"}}},
  {bcrypt, ".*", {git, "https://github.com/erlangpack/bcrypt", {branch, "master"}}},
  {erlpass, ".*", {git, "https://github.com/ferd/erlpass.git", {branch, "master"}}},
  {folsom, ".*", {git, "https://github.com/folsom-project/folsom.git", {tag, "0.8.7"}}},

  % mod_geoip
  {certifi, ".*", {git, "https://github.comcertifi/erlang-certifi.git", {tag, "2.5.1"}}},
  {stacktrace_compat, ".*", {git, "https://github.com/zotonic/stacktrace_compat.git", {branch, "1.1.1-rebar2"}}},
  {ssl_verify_fun, ".*", {git, "https://github.com/deadtrickster/ssl_verify_fun.erl.git", {tag, "1.1.5"}}},
  {locus, ".*", {git, "https://github.com/g-andrade/locus.git", {tag, "1.9.0"}}}
 ]
}.

{plugin_dir, "deps/rebar_lock_deps_plugin/src"}.
{plugins, [rebar_lock_deps_plugin]}.

{xref_checks, [undefined_function_calls,
               locals_not_used,
               deprecated_function_calls]}.

